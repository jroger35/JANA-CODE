<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Flashcard Loop with 2 Images per Question</title>
<style>
  body { font-family: Arial; padding: 20px; }
  .feedback { margin-top: 10px; font-weight: bold; }
  .incorrect { color: red; }
  .correct { color: green; }
  button { margin-top: 10px; margin-right: 5px; }
  .images { display: flex; gap: 10px; margin-top: 10px; }
  /* First image reduced by ~30% */
  .images img:first-child { 
    flex: 0.7;       
    max-width: 30%;  
    max-height: 200px; 
    object-fit: contain; 
  }
  .images img:last-child { 
    flex: 1.3;       
    width: 70%; 
    height: auto; 
    object-fit: contain; 
  }
  .progress { margin-bottom: 15px; font-weight: bold; }
</style>
</head>
<body>
<h2>Flashcard Practice: Achieve 2 Correct Attempts Per Question</h2>

<div id="question-container"></div>

<script>

const imageKeyboard = "https://raw.githubusercontent.com/jroger35/JANA-CODE/main/Images/Keyboard_Cat-Dog-Emu.JPG";

const questions = [
  {
    text: "Page 1 - What is the note on the staff?",
    images: [
      "https://www.w3schools.com/images/w3schools_green.jpg",
      imageKeyboard 
    ],
    options: [
      { text: "A", feedback: "No, that's not correct. Look at the second line from the bottom." },
      { text: "B", feedback: "Correct! B is the note on the second line.", correct: true },
      { text: "C", feedback: "Not quite. C is higher than the note on this staff." },
      { text: "D", feedback: "Incorrect. D is above the staff." }
    ],
    consecutiveCorrect: 0
  },
  {
    text: "Page 2 - What is the note on the staff?",
    images: [
      "https://www.w3schools.com/images/w3schools_green.jpg",
      imageKeyboard 
    ],
    options: [
      { text: "E", feedback: "No, check the third line from the bottom." },
      { text: "F", feedback: "Not quite. This note is lower." },
      { text: "G", feedback: "Correct! G is on the second line from the top.", correct: true },
      { text: "A", feedback: "Incorrect. A is higher than this note." }
    ],
    consecutiveCorrect: 0
  },
  {
    text: "Page 3 - Identify the note on this staff",
    images: [
      "https://www.w3schools.com/images/w3schools_green.jpg",
      imageKeyboard 
    ],
    options: [
      { text: "C", feedback: "Incorrect. Look at the middle line." },
      { text: "D", feedback: "Correct! D is on the middle line.", correct: true },
      { text: "E", feedback: "No, E is above this note." },
      { text: "F", feedback: "Not quite. F is too high." }
    ],
    consecutiveCorrect: 0
  }
];

let currentQuestionIndex = 0;
let firstAttempt = true;
const container = document.getElementById("question-container");

function showCurrentQuestion() {
  const activeQuestions = questions.filter(q => q.consecutiveCorrect < 2);
  if (activeQuestions.length === 0) {
    showCompletionMessage();
    return;
  }

  if (currentQuestionIndex >= activeQuestions.length) currentQuestionIndex = 0;
  const q = activeQuestions[currentQuestionIndex];
  firstAttempt = true;

  container.innerHTML = "";

  // Progress display
  const progress = document.createElement("div");
  progress.classList.add("progress");
  progress.textContent = `Questions mastered (2 correct in a row): ${questions.filter(q => q.consecutiveCorrect >= 2).length} / ${questions.length}`;
  container.appendChild(progress);

  // Question text
  const questionText = document.createElement("div");
  questionText.innerHTML = `<strong>Q${currentQuestionIndex + 1}:</strong> ${q.text}`;
  container.appendChild(questionText);

  // Two images side by side
  const imageContainer = document.createElement("div");
  imageContainer.classList.add("images");
  q.images.forEach(imgUrl => {
    const img = document.createElement("img");
    img.src = imgUrl;
    img.alt = "Question Image";
    imageContainer.appendChild(img);
  });
  container.appendChild(imageContainer);

  // Option buttons
  q.options.forEach(opt => {
    const btn = document.createElement("button");
    btn.textContent = opt.text;
    btn.onclick = () => handleAnswer(opt, q, activeQuestions);
    container.appendChild(btn);
  });

  // Feedback
  const fb = document.createElement("div");
  fb.classList.add("feedback");
  container.appendChild(fb);

  // Next button
  const nextBtn = document.createElement("button");
  nextBtn.textContent = "Next Question âž¡";
  nextBtn.onclick = () => {
    currentQuestionIndex = (currentQuestionIndex + 1) % activeQuestions.length;
    showCurrentQuestion();
  };
  container.appendChild(nextBtn);
}

function handleAnswer(option, question, activeQuestions) {
  const fb = container.querySelector(".feedback");
  fb.textContent = option.feedback;
  fb.classList.remove("incorrect", "correct");

  if (option.correct) {
    fb.classList.add("correct");
    if (firstAttempt) question.consecutiveCorrect++;
  } else {
    fb.classList.add("incorrect");
    question.consecutiveCorrect = 0;
  }

  firstAttempt = false;

  if (questions.every(q => q.consecutiveCorrect >= 2)) showCompletionMessage();

  const progress = container.querySelector(".progress");
  progress.textContent = `Questions mastered (2 correct in a row): ${questions.filter(q => q.consecutiveCorrect >= 2).length} / ${questions.length}`;
}

function showCompletionMessage() {
  container.innerHTML = "";

  // Define the approved ranges
  const ranges = [
    { min: 5815, max: 5820 },
    { min: 1264, max: 1270 },
    { min: 9836, max: 9840 }
  ];

  // Pick a random range
  const chosenRange = ranges[Math.floor(Math.random() * ranges.length)];

  // Pick a random number in that range
  const completionCode = Math.floor(
    Math.random() * (chosenRange.max - chosenRange.min + 1)
  ) + chosenRange.min;

  // Display the message
  const completeMsg = document.createElement("h3");
  completeMsg.textContent = "Mastery achieved! Input this special code on the next page to get credit!";
  container.appendChild(completeMsg);

  const codeMsg = document.createElement("div");
  codeMsg.style.fontSize = "24px";
  codeMsg.style.fontWeight = "bold";
  codeMsg.style.marginTop = "20px";
  codeMsg.style.color = "#0073e6";
  codeMsg.textContent = "Your completion code is: " + completionCode;
  container.appendChild(codeMsg);

  const note = document.createElement("p");
  note.textContent = "Write this code down to prove you completed the activity.";
  note.style.marginTop = "10px";
  container.appendChild(note);
}

showCurrentQuestion();
</script>
</body>
</html>

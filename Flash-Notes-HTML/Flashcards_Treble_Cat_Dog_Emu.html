<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Flashcard Loop with 2 Images per Question</title>
<style>
  body { font-family: Arial; padding: 20px; }
  .feedback { margin-top: 10px; font-weight: bold; }
  .incorrect { color: black; }
  .correct { color: black; }
  button { margin-top: 10px; margin-right: 5px; }
  .images { display: flex; gap: 10px; margin-top: 10px; }
  /* First image reduced by ~30% */
  .images img:first-child { 
    flex: 0.7;       
    max-width: 30%;  
    max-height: 200px; 
    object-fit: contain; 
  }
  .images img:last-child { 
    flex: 1.3;       
    width: 70%; 
    height: auto; 
    object-fit: contain; 
  }
  .progress { margin-bottom: 15px; font-weight: bold; }
</style>
</head>
<body>
<h2>Flash Notes: For same note, get 2 correct on first try - Cat, Dog, Emu.</h2>

<div id="question-container"></div>

<script>

const imageKeyboard = "https://raw.githubusercontent.com/jroger35/JANA-CODE/main/Images/Keyboard_Cat_Dog_Emu.jpg";

const correctCat = "Correct! That is the Cat, outside the Dog House.";
const correctDog = "Correct! That is the Dog inside the Dog House.";
const correctEmu = "Correct! That is the Emu, on the other side of the Dog House.";

const wrongCat = "Try again. Cat is on the outside of the Dog House.";
const wrongDog = "Try again. Dog is inside the Dog House."; 
const wrongEmu = "Try again. Emu is on the other side of the Dog House."; 
const wrongFrog = "Try again. Frog is not a key around the Dog House."; 
const wrongBee = "Try again. Bee is not a key around the Dog House."; 
const questions = [
  {
    text: "Note 1 - What is the note on the staff?",
    images: [
      "https://raw.githubusercontent.com/jroger35/JANA-CODE/main/Images/Note_Treble_C.jpg",
      imageKeyboard 
    ],
    options: [
      { text: "Cat", feedback: correctCat, correct: true },
      { text: "Dog", feedback: wrongDog },
      { text: "Emu", feedback: wrongEmu },
      { text: "Frog", feedback: wrongFrog }
    ],
    consecutiveCorrect: 0
  },
  {
    text: "Note 2 - What is the note on the staff?",
    images: [
      "https://raw.githubusercontent.com/jroger35/JANA-CODE/main/Images/Note_Treble_D.jpg",
      imageKeyboard 
    ],
    options: [
      { text: "Cat", feedback: wrongCat },
      { text: "Dog", feedback: correctDog, correct: true},
      { text: "Emu", feedback: wrongEmu,  },
      { text: "Bee", feedback: wrongBee}
    ],
    consecutiveCorrect: 0
  },
  {
    text: "Note 3 - What is the note on the staff?",
    images: [
      "https://raw.githubusercontent.com/jroger35/JANA-CODE/main/Images/Note_Treble_E.jpg",
      imageKeyboard 
    ],
    options: [
      { text: "Cat", feedback: wrongCat},
      { text: "Dog", feedback: wrongDog},
      { text: "Emu", feedback: correctEmu, correct: true },
      { text: "Frog", feedback: wrongFrog}
    ],
    consecutiveCorrect: 0
  }
];

let currentQuestionIndex = 0;
let firstAttempt = true;
const container = document.getElementById("question-container");

function showCurrentQuestion() {
  const activeQuestions = questions.filter(q => q.consecutiveCorrect < 2);
  if (activeQuestions.length === 0) {
    showCompletionMessage();
    return;
  }

  if (currentQuestionIndex >= activeQuestions.length) currentQuestionIndex = 0;
  const q = activeQuestions[currentQuestionIndex];
  firstAttempt = true;

  container.innerHTML = "";

  // Progress display
  const progress = document.createElement("div");
  progress.classList.add("progress");
  progress.textContent = `To master: For same note, 2 correct in a row on first try.: ${questions.filter(q => q.consecutiveCorrect >= 2).length} / ${questions.length}`;
  container.appendChild(progress);

  // Question text
  const questionText = document.createElement("div");
  questionText.innerHTML = `<strong>Q${currentQuestionIndex + 1}:</strong> ${q.text}`;
  container.appendChild(questionText);

  // Two images side by side
  const imageContainer = document.createElement("div");
  imageContainer.classList.add("images");
  q.images.forEach(imgUrl => {
    const img = document.createElement("img");
    img.src = imgUrl;
    img.alt = "Question Image";
    imageContainer.appendChild(img);
  });
  container.appendChild(imageContainer);

  // Option buttons
  shuffle(q.options).forEach(opt => {
    const btn = document.createElement("button");
    btn.textContent = opt.text;
    btn.onclick = () => handleAnswer(opt, q, activeQuestions);
    container.appendChild(btn);
  });

  // Feedback
  const fb = document.createElement("div");
  fb.classList.add("feedback");
  container.appendChild(fb);

  // Next button
  const nextBtn = document.createElement("button");
  nextBtn.textContent = "Next Question ➡";
  nextBtn.onclick = () => {
    currentQuestionIndex = (currentQuestionIndex + 1) % activeQuestions.length;
    showCurrentQuestion();
  };
  container.appendChild(nextBtn);
}

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function handleAnswer(option, question, activeQuestions) {
  const fb = container.querySelector(".feedback");
  fb.textContent = option.feedback;
  fb.classList.remove("incorrect", "correct");

  if (option.correct) {
    fb.innerHTML = `<span style="color:green;">✅</span> ${fb.textContent}`;
    fb.classList.add("correct");
    if (firstAttempt) question.consecutiveCorrect++;
  } else {
    fb.innerHTML = `<span style="color:red;">✖</span> ${fb.textContent}`;
    fb.classList.add("incorrect");
    question.consecutiveCorrect = 0;
  }


  firstAttempt = false;

  if (questions.every(q => q.consecutiveCorrect >= 2)) showCompletionMessage();

  const progress = container.querySelector(".progress");
  progress.textContent = `Questions mastered (2 correct in a row): ${questions.filter(q => q.consecutiveCorrect >= 2).length} / ${questions.length}`;
}

function showCompletionMessage() {
  container.innerHTML = "";

  // Define the approved ranges
  const ranges = [
    { min: 5815, max: 5820 },
    { min: 1264, max: 1270 },
    { min: 9836, max: 9840 }
  ];

  // Pick a random range
  const chosenRange = ranges[Math.floor(Math.random() * ranges.length)];

  // Pick a random number in that range
  const completionCode = Math.floor(
    Math.random() * (chosenRange.max - chosenRange.min + 1)
  ) + chosenRange.min;

  // Display the message
  const completeMsg = document.createElement("h3");
  completeMsg.textContent = "Mastery achieved! Input this code on the next page to get credit.";
  container.appendChild(completeMsg);

  const codeMsg = document.createElement("div");
  codeMsg.style.fontSize = "24px";
  codeMsg.style.fontWeight = "bold";
  codeMsg.style.marginTop = "20px";
  codeMsg.style.color = "#0073e6";
  codeMsg.textContent = "Your completion code is: " + completionCode;
  container.appendChild(codeMsg);
 

// Navigation Button to the Canvas quiz
  const nextButton = document.createElement("a");
  nextButton.textContent = "Continue to Input Code";
  nextButton.href = "https://canvas.instructure.com/courses/13454078/quizzes/24087249/take";
  nextButton.target = "_top"; 
  nextButton.style.display = "inline-block";
  nextButton.style.marginTop = "25px";
  nextButton.style.padding = "12px 18px";
  nextButton.style.backgroundColor = "#28a745";
  nextButton.style.color = "#fff";
  nextButton.style.fontSize = "18px";
  nextButton.style.fontWeight = "bold";
  nextButton.style.textDecoration = "none";
  nextButton.style.borderRadius = "6px";
  nextButton.style.border = "2px solid #1e7e34";

  container.appendChild(nextButton);
}

showCurrentQuestion();
</script>
</body>
</html>
